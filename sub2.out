2023-04-04 16:05:23,750 - INFO - Main - acquire a child logger
2023-04-04 16:05:23,750 - DEBUG - Main: parse command line arguments
2023-04-04 16:05:23,755 - DEBUG - Main: resetting log level to 20
2023-04-04 16:05:23,755 - INFO - SubscriberAppln::configure
2023-04-04 16:05:23,767 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:23,769 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:23,897 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:23,899 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,060 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,061 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,359 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,360 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:25,011 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:25,013 - DEBUG - Sending request(xid=None): Connect(protocol_version=0, last_zxid_seen=0, time_out=10000, session_id=0, passwd=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', read_only=None)
2023-04-04 16:05:25,016 - INFO - Zookeeper connection established, state: CONNECTED
2023-04-04 16:05:25,016 - DEBUG - Sending request(xid=1): Exists(path='/leader', watcher=None)
2023-04-04 16:05:26,030 - DEBUG - Sending request(xid=2): Exists(path='/leader', watcher=None)
2023-04-04 16:05:26,031 - DEBUG - Received response(xid=2): ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14)
2023-04-04 16:05:26,031 - DEBUG - Sending request(xid=3): GetData(path='/leader', watcher=None)
2023-04-04 16:05:26,033 - DEBUG - Received response(xid=3): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:26,033 - INFO - SubscriberMW::configure completed
2023-04-04 16:05:26,033 - INFO - SubscriberAppln::configure - completed
2023-04-04 16:05:26,033 - INFO - SubscriberAppln::driver
2023-04-04 16:05:26,033 - INFO - **********************************
2023-04-04 16:05:26,033 - INFO - PublisherAppln::dump
2023-04-04 16:05:26,033 - INFO - ------------------------------
2023-04-04 16:05:26,033 - INFO -      Name: sub2
2023-04-04 16:05:26,033 - INFO -      Lookup: Centralized
2023-04-04 16:05:26,033 - INFO -      Dissemination: Broker
2023-04-04 16:05:26,033 - INFO -      Num Topics: 5
2023-04-04 16:05:26,033 - INFO -      TopicList: ['temperature', 'airquality', 'location', 'altitude', 'sound']
2023-04-04 16:05:26,033 - INFO - **********************************
2023-04-04 16:05:26,034 - DEBUG - Sending request(xid=4): GetData(path='/leader', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7f99088cb6a0>>)
2023-04-04 16:05:26,036 - DEBUG - Received response(xid=4): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:26,036 - INFO - SubscriberMW::watch_leader: leader node changed
2023-04-04 16:05:26,036 - DEBUG - Sending request(xid=5): Exists(path='/leader', watcher=None)
2023-04-04 16:05:26,037 - DEBUG - Received response(xid=5): ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14)
2023-04-04 16:05:26,038 - DEBUG - Sending request(xid=6): GetData(path='/leader', watcher=None)
2023-04-04 16:05:26,039 - DEBUG - Received response(xid=6): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:26,040 - INFO - SubscriberMW::set_req: disconnecting from tcp://10.0.0.3:5555
2023-04-04 16:05:26,041 - DEBUG - Sending request(xid=7): GetData(path='/broker', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7f99088cbc70>>)
2023-04-04 16:05:26,043 - DEBUG - Received response(xid=7): (b'{"id": "broker1", "addr": "10.0.0.11", "port": 7777}', ZnodeStat(czxid=18, mzxid=18, ctime=1680642325569, mtime=1680642325569, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637129, dataLength=52, numChildren=0, pzxid=18))
2023-04-04 16:05:26,043 - INFO - SubscriberMW::watch_broker: broker node changed
2023-04-04 16:05:26,043 - INFO - SubscriberAppln::re_lookup - send LOOKUP msg to discovery service
2023-04-04 16:05:26,044 - INFO - SubscriberMW::lookup
2023-04-04 16:05:26,044 - INFO - SubscriberMW::lookup - done building lookup request to discovery service
2023-04-04 16:05:26,044 - INFO - SubscriberMW::lookup - sent lookup message and now wait for reply
2023-04-04 16:05:26,044 - DEBUG - Sending request(xid=8): GetChildren(path='/publisher', watcher=<bound method ChildrenWatch._watcher of <kazoo.recipe.watchers.ChildrenWatch object at 0x7f99088cbcd0>>)
2023-04-04 16:05:26,045 - DEBUG - Received response(xid=8): ['pub5', 'pub6', 'pub7']
2023-04-04 16:05:26,045 - INFO - SubscriberMW::watch_pubs: publishers changed, sending lookup request
2023-04-04 16:05:26,045 - INFO - SubscriberAppln::invoke_operation
2023-04-04 16:05:26,045 - INFO - SubscriberMW: register
2023-04-04 16:05:26,045 - INFO - SubscriberAppln::invoke_operation
2023-04-04 16:05:26,045 - INFO - SubscriberMW::lookup
2023-04-04 16:05:26,045 - INFO - SubscriberMW::lookup - done building lookup request to discovery service
2023-04-04 16:05:26,046 - ERROR - Exception caught in main - Operation cannot be accomplished in current state
