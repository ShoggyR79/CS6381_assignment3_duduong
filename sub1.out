2023-04-04 16:05:23,796 - INFO - Main - acquire a child logger
2023-04-04 16:05:23,796 - DEBUG - Main: parse command line arguments
2023-04-04 16:05:23,800 - DEBUG - Main: resetting log level to 20
2023-04-04 16:05:23,800 - INFO - SubscriberAppln::configure
2023-04-04 16:05:23,803 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:23,805 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:23,940 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:23,942 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,141 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,145 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,551 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,552 - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:25,087 - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:25,089 - DEBUG - Sending request(xid=None): Connect(protocol_version=0, last_zxid_seen=0, time_out=10000, session_id=0, passwd=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', read_only=None)
2023-04-04 16:05:25,094 - INFO - Zookeeper connection established, state: CONNECTED
2023-04-04 16:05:25,094 - DEBUG - Sending request(xid=1): Exists(path='/leader', watcher=None)
2023-04-04 16:05:25,095 - DEBUG - Received response(xid=1): ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14)
2023-04-04 16:05:25,095 - DEBUG - Sending request(xid=2): GetData(path='/leader', watcher=None)
2023-04-04 16:05:25,096 - DEBUG - Received response(xid=2): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:25,097 - INFO - SubscriberMW::configure completed
2023-04-04 16:05:25,097 - INFO - SubscriberAppln::configure - completed
2023-04-04 16:05:25,097 - INFO - SubscriberAppln::driver
2023-04-04 16:05:25,097 - INFO - **********************************
2023-04-04 16:05:25,097 - INFO - PublisherAppln::dump
2023-04-04 16:05:25,098 - INFO - ------------------------------
2023-04-04 16:05:25,099 - INFO -      Name: sub1
2023-04-04 16:05:25,100 - INFO -      Lookup: Centralized
2023-04-04 16:05:25,100 - INFO -      Dissemination: Broker
2023-04-04 16:05:25,100 - INFO -      Num Topics: 5
2023-04-04 16:05:25,101 - INFO -      TopicList: ['altitude', 'temperature', 'sound', 'airquality', 'pressure']
2023-04-04 16:05:25,101 - INFO - **********************************
2023-04-04 16:05:25,103 - DEBUG - Sending request(xid=3): GetData(path='/leader', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7fc1150676a0>>)
2023-04-04 16:05:25,105 - DEBUG - Received response(xid=3): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:25,105 - INFO - SubscriberMW::watch_leader: leader node changed
2023-04-04 16:05:25,105 - DEBUG - Sending request(xid=4): Exists(path='/leader', watcher=None)
2023-04-04 16:05:25,106 - DEBUG - Received response(xid=4): ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14)
2023-04-04 16:05:25,106 - DEBUG - Sending request(xid=5): GetData(path='/leader', watcher=None)
2023-04-04 16:05:25,107 - DEBUG - Received response(xid=5): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:25,107 - INFO - SubscriberMW::set_req: disconnecting from tcp://10.0.0.3:5555
2023-04-04 16:05:25,107 - DEBUG - Sending request(xid=6): GetData(path='/broker', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7fc115067c70>>)
2023-04-04 16:05:25,110 - DEBUG - Received error(xid=6) NoNodeError()
2023-04-04 16:05:25,110 - DEBUG - Sending request(xid=7): Exists(path='/broker', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7fc115067c70>>)
2023-04-04 16:05:25,127 - INFO - SubscriberMW::watch_broker: broker node changed
2023-04-04 16:05:25,127 - INFO - SubscriberAppln::re_lookup - send LOOKUP msg to discovery service
2023-04-04 16:05:25,127 - INFO - SubscriberMW::lookup
2023-04-04 16:05:25,127 - INFO - SubscriberMW::lookup - done building lookup request to discovery service
2023-04-04 16:05:25,127 - INFO - SubscriberMW::lookup - sent lookup message and now wait for reply
2023-04-04 16:05:25,128 - DEBUG - Sending request(xid=8): GetChildren(path='/publisher', watcher=<bound method ChildrenWatch._watcher of <kazoo.recipe.watchers.ChildrenWatch object at 0x7fc115067e20>>)
2023-04-04 16:05:25,130 - DEBUG - Received response(xid=8): []
2023-04-04 16:05:25,131 - INFO - SubscriberMW::watch_pubs: publishers changed, sending lookup request
2023-04-04 16:05:25,131 - INFO - SubscriberAppln::invoke_operation
2023-04-04 16:05:25,131 - INFO - SubscriberMW: register
2023-04-04 16:05:25,131 - INFO - SubscriberAppln::invoke_operation
2023-04-04 16:05:25,131 - INFO - SubscriberMW::lookup
2023-04-04 16:05:25,132 - INFO - SubscriberMW::lookup - done building lookup request to discovery service
2023-04-04 16:05:25,132 - ERROR - Exception caught in main - Operation cannot be accomplished in current state
