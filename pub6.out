2023-04-04 16:05:23,734 - root - INFO - Main - acquire a child logger and then log messages in the child
2023-04-04 16:05:23,734 - PublisherAppln - DEBUG - Main: parse command line arguments
2023-04-04 16:05:23,738 - PublisherAppln - DEBUG - Main: resetting log level to 20
2023-04-04 16:05:23,739 - PublisherAppln - INFO - PublisherAppln::configure
2023-04-04 16:05:23,739 - PublisherAppln - INFO - PublisherMW::configure
2023-04-04 16:05:23,759 - kazoo.client - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:23,761 - kazoo.client - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:23,838 - kazoo.client - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:23,839 - kazoo.client - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,016 - kazoo.client - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,018 - kazoo.client - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,257 - kazoo.client - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,258 - kazoo.client - WARNING - Connection dropped: socket connection error: Connection refused
2023-04-04 16:05:24,774 - kazoo.client - INFO - Connecting to 10.0.0.1(10.0.0.1):2181, use_ssl: False
2023-04-04 16:05:24,775 - kazoo.client - DEBUG - Sending request(xid=None): Connect(protocol_version=0, last_zxid_seen=0, time_out=10000, session_id=0, passwd=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', read_only=None)
2023-04-04 16:05:24,807 - kazoo.client - INFO - Zookeeper connection established, state: CONNECTED
2023-04-04 16:05:24,807 - kazoo.client - DEBUG - Sending request(xid=1): Exists(path='/leader', watcher=None)
2023-04-04 16:05:25,815 - kazoo.client - DEBUG - Sending request(xid=2): Exists(path='/leader', watcher=None)
2023-04-04 16:05:25,817 - kazoo.client - DEBUG - Received response(xid=2): ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14)
2023-04-04 16:05:25,817 - kazoo.client - DEBUG - Sending request(xid=3): GetData(path='/leader', watcher=None)
2023-04-04 16:05:25,821 - kazoo.client - DEBUG - Received response(xid=3): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:25,821 - kazoo.client - DEBUG - Sending request(xid=4): GetData(path='/leader', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7f5dc84c14b0>>)
2023-04-04 16:05:25,822 - kazoo.client - DEBUG - Received response(xid=4): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:25,823 - PublisherAppln - INFO - PublisherMW::watch_leader: leader node changed
2023-04-04 16:05:25,823 - kazoo.client - DEBUG - Sending request(xid=5): GetData(path='/leader', watcher=None)
2023-04-04 16:05:25,824 - kazoo.client - DEBUG - Received response(xid=5): (b'{"name": "disc2", "rep_addr": "tcp://10.0.0.3:5555", "pub_addr": "tcp://10.0.0.3:5556"}', ZnodeStat(czxid=14, mzxid=14, ctime=1680642325037, mtime=1680642325037, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637127, dataLength=87, numChildren=0, pzxid=14))
2023-04-04 16:05:25,825 - PublisherAppln - INFO - PublisherMW::watch_leader: disconnecting req and redirecting to new leader
2023-04-04 16:05:25,825 - PublisherAppln - INFO - Successfully connected to new leader
2023-04-04 16:05:25,825 - PublisherAppln - INFO - PublisherMW::configure completed
2023-04-04 16:05:25,826 - PublisherAppln - INFO - PublisherMW::configure completed
2023-04-04 16:05:25,826 - PublisherAppln - INFO - PublisherAppln::configure - configuration complete
2023-04-04 16:05:25,826 - PublisherAppln - INFO - PublisherAppln::driver
2023-04-04 16:05:25,826 - PublisherAppln - INFO - **********************************
2023-04-04 16:05:25,826 - PublisherAppln - INFO - PublisherAppln::dump
2023-04-04 16:05:25,826 - PublisherAppln - INFO - ------------------------------
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      Name: pub6
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      Lookup: Centralized
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      Dissemination: Broker
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      Num Topics: 5
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      TopicList: ['altitude', 'temperature', 'humidity', 'pressure', 'weather']
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      Iterations: 1000
2023-04-04 16:05:25,826 - PublisherAppln - INFO -      Frequency: 1
2023-04-04 16:05:25,826 - PublisherAppln - INFO - **********************************
2023-04-04 16:05:25,826 - PublisherAppln - INFO - PublisherMW::event_loop - run the event loop
2023-04-04 16:05:25,827 - PublisherAppln - INFO - PublisherAppln::invoke_operation
2023-04-04 16:05:25,827 - PublisherAppln - INFO - PublisherAppln::invoke_operation - state = State.REGISTER
2023-04-04 16:05:25,827 - PublisherAppln - INFO - PublisherMW::register
2023-04-04 16:05:25,827 - kazoo.client - DEBUG - Sending request(xid=6): Create(path='/publisher/pub6', data=b'{"id": {"id": "pub6", "addr": "10.0.0.6", "port": 5577}, "topiclist": ["altitude", "temperature", "humidity", "pressure", "weather"]}', acl=[ACL(perms=31, acl_list=['ALL'], id=Id(scheme='world', id='anyone'))], flags=1)
2023-04-04 16:05:25,835 - kazoo.client - DEBUG - Received response(xid=6): '/publisher/pub6'
2023-04-04 16:05:25,835 - PublisherAppln - INFO - PublisherMW::register - sent register message and now now wait for reply
2023-04-04 16:05:25,835 - PublisherAppln - INFO - PublisherAppln::invoke_operation
2023-04-04 16:05:25,835 - PublisherAppln - INFO - PublisherAppln::invoke_operation - state = State.DISSEMINATE
2023-04-04 16:05:35,340 - kazoo.client - DEBUG - Received EVENT: Watch(type=2, state=3, path='/leader')
2023-04-04 16:05:35,342 - kazoo.client - DEBUG - Sending request(xid=7): GetData(path='/leader', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7f5dc84c14b0>>)
2023-04-04 16:05:35,344 - kazoo.client - DEBUG - Received error(xid=7) NoNodeError()
2023-04-04 16:05:35,346 - kazoo.client - DEBUG - Sending request(xid=8): Exists(path='/leader', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7f5dc84c14b0>>)
2023-04-04 16:05:35,349 - PublisherAppln - INFO - PublisherMW::watch_leader: leader node changed
2023-04-04 16:05:35,349 - kazoo.client - DEBUG - Sending request(xid=9): GetData(path='/leader', watcher=None)
2023-04-04 16:05:35,351 - kazoo.client - DEBUG - Received EVENT: Watch(type=1, state=3, path='/leader')
2023-04-04 16:05:35,353 - kazoo.client - DEBUG - Received response(xid=9): (b'{"name": "disc3", "rep_addr": "tcp://10.0.0.4:5555", "pub_addr": "tcp://10.0.0.4:5556"}', ZnodeStat(czxid=28, mzxid=28, ctime=1680642335348, mtime=1680642335348, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637124, dataLength=87, numChildren=0, pzxid=28))
2023-04-04 16:05:35,353 - PublisherAppln - INFO - PublisherMW::watch_leader: disconnecting req and redirecting to new leader
2023-04-04 16:05:35,353 - PublisherAppln - INFO - Successfully connected to new leader
2023-04-04 16:05:35,354 - kazoo.client - DEBUG - Sending request(xid=10): GetData(path='/leader', watcher=<bound method DataWatch._watcher of <kazoo.recipe.watchers.DataWatch object at 0x7f5dc84c14b0>>)
2023-04-04 16:05:35,355 - kazoo.client - DEBUG - Received response(xid=10): (b'{"name": "disc3", "rep_addr": "tcp://10.0.0.4:5555", "pub_addr": "tcp://10.0.0.4:5556"}', ZnodeStat(czxid=28, mzxid=28, ctime=1680642335348, mtime=1680642335348, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637124, dataLength=87, numChildren=0, pzxid=28))
2023-04-04 16:05:35,356 - PublisherAppln - INFO - PublisherMW::watch_leader: leader node changed
2023-04-04 16:05:35,356 - kazoo.client - DEBUG - Sending request(xid=11): GetData(path='/leader', watcher=None)
2023-04-04 16:05:35,357 - kazoo.client - DEBUG - Received response(xid=11): (b'{"name": "disc3", "rep_addr": "tcp://10.0.0.4:5555", "pub_addr": "tcp://10.0.0.4:5556"}', ZnodeStat(czxid=28, mzxid=28, ctime=1680642335348, mtime=1680642335348, version=0, cversion=0, aversion=0, ephemeralOwner=72059897973637124, dataLength=87, numChildren=0, pzxid=28))
2023-04-04 16:05:35,358 - PublisherAppln - INFO - PublisherMW::watch_leader: disconnecting req and redirecting to new leader
2023-04-04 16:05:35,358 - PublisherAppln - INFO - Successfully connected to new leader
